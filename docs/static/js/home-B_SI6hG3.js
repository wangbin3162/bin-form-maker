import{n as ke,a8 as P,ad as I,ae as Y,Q as u,o as s,j as V,K as t,w as e,a as k,H as M,b as m,t as T,i as W,e as N,T as le,x as We,L as r,ah as Ce,X as re,r as D,J as me,a2 as Q,R as U,O as ee,g as be,v as ve,f as h,I as Fe,l as ae,F as R,af as Te,ag as Oe,Z as Ve,Y as je,ak as ze}from"./vendor-DnHOeT5O.js";import{u as Ue,c as Ne,n as ne}from"./chunk-bin-ui-design-c3Dd35Rn.js";import{u as L,f as ge,c as ye,l as Be,b as Ae,i as G,a as Re,g as Me,d as Le,D as oe,C as Ee,e as Ie,O as he,h as Pe,j as H,k as qe,m as He,n as Je}from"./index-DlOkYcmK.js";import"./chunk-brace-DiF9biBn.js";function Ye(n){const{addClass:a,removeClass:o,hasClass:c,getStyle:l,getScrollBarWidth:p}=Ue.dom;let i=0,d=!1,y="0",v=0,f=null;ke(n,b=>{if(b){f&&clearTimeout(f),d=!c(document.body,"bin-popup-parent--hidden"),d&&(y=document.body.style.paddingRight,v=parseInt(l(document.body,"paddingRight"),10)),i=p();const _=document.documentElement.clientHeight<document.body.scrollHeight,g=l(document.body,"overflowY");a(document.body,"bin-popup-parent--hidden"),i>0&&(_||g==="scroll")&&d&&(document.body.style.paddingRight=v+i+"px",a(document.body,"with-scrollbar"))}else f=setTimeout(()=>{d&&(document.body.style.paddingRight=y,o(document.body,"bin-popup-parent--hidden"),o(document.body,"with-scrollbar")),d=!0},300)})}const Ke={class:"fm-header"},Qe={class:"title"},Xe={class:"logo"},Ze={class:"over-hidden"},Ge={key:0},et={class:"right"},tt={class:"fm-content"},lt=Object.assign({name:"MakerLayout"},{__name:"index",props:I({topTitle:{type:String,default:"FormMaker 表单设计器"},inner:Boolean,appendToBody:{type:Boolean,default:!0}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:I(["close","rollback"],["update:modelValue"]),setup(n,{emit:a}){const o=a,c=Y(n,"modelValue");Ye(c);function l(){Ne.confirm({type:"warning",title:"提示",message:'<p>没有保存的内容会<span style="color:red;">丢失</span>！确认返回吗？</p>',useHTML:!0}).then(()=>{c.value=!1,o("close")}).catch(()=>{})}return(p,i)=>{const d=u("b-icon");return s(),V(We,{to:"body",disabled:!n.appendToBody},[t(le,{name:"move-right"},{default:e(()=>[c.value?(s(),k("div",{key:0,class:M(["fm-container maker-layout",{inner:n.inner}])},[m("div",Ke,[m("div",Qe,[m("span",Xe,[t(d,{name:"insertrowabove",size:"24"})]),m("div",Ze,[n.topTitle?(s(),k("span",Ge,T(n.topTitle),1)):W("",!0)])]),m("div",et,[t(d,{name:"close",type:"button",onClick:l})])]),m("div",tt,[N(p.$slots,"default",{},void 0,!0)])],2)):W("",!0)]),_:3})],8,["disabled"])}}}),ot=P(lt,[["__scopeId","data-v-41d9248e"]]),nt={class:"title"},at=["onClick"],it={key:0},st={class:"field-name"},dt={class:"field-name"},ct=Object.assign({name:"CompList"},{__name:"comp-list",props:{title:{type:String,default:""},list:{type:Array,default:()=>[]},isCustom:{type:Boolean,default:!1},isField:{type:Boolean,default:!1}},setup(n){const a=n,{addWidget:o,alreadyInFieldModels:c}=L();function l(i){if(c.value.includes(i.fieldName))return;const d=a.isField?ge(i):ye(i.type,i.name,a.isCustom);o(d)}function p(i){return a.isField?ge(i):ye(i.type,i.name,a.isCustom)}return(i,d)=>{const y=u("b-icon"),v=u("b-collapse-wrap");return s(),V(v,{collapse:"",style:{margin:"0 0 1px"}},{title:e(()=>[m("span",nt,T(n.title),1)]),default:e(()=>[t(r(Ce),re({tag:"ul",list:n.list,"item-key":"type"},{group:{name:"form",pull:"clone",put:!1},sort:!1,ghostClass:"ghost"},{filter:".disabled",clone:p}),{item:e(({element:f})=>[m("li",{class:M(["form-edit-widget-label no-put",{disabled:r(c).includes(f.fieldName)}]),onClick:b=>l(f)},[n.isField?(s(),k("a",{key:1,class:M({required:f.required})},[m("span",dt,T(f.fieldTitle),1)],2)):(s(),k("a",it,[t(y,{name:f.icon},null,8,["name"]),m("span",st,T(f.name),1)]))],10,at)]),_:1},16,["list"])]),_:1})}}}),te=P(ct,[["__scopeId","data-v-576c4456"]]),ut={class:"components-list"},rt={class:"top-fix"},mt={class:"config-content"},pt={key:0},ft={key:1,class:"p8"},_t=Object.assign({name:"CompsList"},{__name:"index",setup(n){const a=D("comps"),o=D(null),c=[{key:"comps",title:"组件",icon:"appstore"},{key:"form",title:"大纲",icon:"cluster"}],{handleSelectWidget:l,treeList:p,ctrlCfgs:i,slotsWedigets:d,realFieldsDtos:y}=L();function v(f,b){var _;if(["col","tag"].includes(b.type))(_=o.value)==null||_.unselectAll();else{const g=i.value[b.model];l(g)}}return(f,b)=>{const _=u("b-tabs"),g=u("b-tree"),O=u("b-scrollbar");return s(),k("div",ut,[m("div",rt,[t(_,{modelValue:a.value,"onUpdate:modelValue":b[0]||(b[0]=j=>a.value=j),data:c},null,8,["modelValue"])]),m("div",mt,[t(O,null,{default:e(()=>[a.value==="comps"?(s(),k("div",pt,[t(te,{title:"布局控件",list:r(Be)},null,8,["list"]),t(te,{title:"表单控件",list:r(Ae)},null,8,["list"]),r(d).length>0?(s(),V(te,{key:0,title:"自定义控件",list:r(d),"is-custom":""},null,8,["list"])):W("",!0),r(y).length>0?(s(),V(te,{key:1,title:"属性字段",list:r(y),"is-field":""},null,8,["list"])):W("",!0)])):(s(),k("div",ft,[t(g,{data:r(p),ref_key:"treeRef",ref:o,onSelectChange:v},null,8,["data"])]))]),_:1})])])}}}),bt=P(_t,[["__scopeId","data-v-f2c56e23"]]),vt=["title"],gt={key:1,style:{height:"32px","background-color":"var(--bin-color-bg-disabled)"},flex:"main:center cross:center"},yt=Object.assign({name:"WidgetFormItem"},{__name:"WidgetFormItem",props:{element:{type:Object,default:()=>({})}},setup(n){const{widgetForm:a,slotsWedigets:o}=L();return(c,l)=>{const p=u("b-icon"),i=u("b-tooltip"),d=u("b-form-item");return s(),V(d,{class:M({"is-required":n.element.config.required})},{label:e(()=>[m("span",{style:{"margin-left":"2px"},class:"over-hidden",title:n.element.label},T(n.element.label),9,vt),n.element.config.tooltip!==""?(s(),V(i,{key:0,content:n.element.config.tooltip,theme:"light"},{default:e(()=>[t(p,{name:"question-circle",style:{"margin-left":"2px"},size:"14"})]),_:1},8,["content"])):W("",!0)]),default:e(()=>[n.element.config.hidden?(s(),k("div",gt," 当前组件属于隐藏状态 ")):(s(),V(me(`BF-${n.element.type}`),{key:0,data:n.element,"model-value":n.element.config.defaultValue,"form-config":r(a).config},Q({_:2},[U(r(o),y=>({name:y.type,fn:e(({node:v})=>[N(c.$slots,y.type,{node:v})])}))]),1032,["data","model-value","form-config"]))]),_:3},8,["class"])}}}),ht=["onClick"],kt=["onClick"],Ct=m("i",{class:"b-iconfont b-icon-drag drag-widget"},null,-1),Vt=[Ct],wt={class:"widget-view-field-name"},$t=Object.assign({name:"WidgetNest"},{__name:"WidgetNest",props:{widgets:{type:Array,default:()=>[]}},setup(n){const{widgetForm:a,slotsWedigets:o,isComSelected:c,deleteWidget:l,handleSelectWidget:p,handleWidgetAdd:i}=L();return(d,y)=>{const v=u("WidgetNest",!0);return s(),V(r(Ce),{tag:"div","item-key":"key",group:"form","ghost-class":"ghost",handle:".drag-widget",list:n.widgets,animation:200,onAdd:y[0]||(y[0]=f=>r(i)(f,n.widgets))},{item:e(({element:f,index:b})=>[m("div",{class:M(["widget-view",{active:r(c)(f),"widget-col":r(G)(f.type)}]),onClick:ee(_=>r(p)(f),["stop"])},[r(G)(f.type)?(s(),V(me(`BF-${f.type}`),{key:0,data:f,"form-config":r(a).config},{default:e(({data:_})=>[t(v,{widgets:_.list,class:"widget-col-list"},null,8,["widgets"])]),_:2},1032,["data","form-config"])):(s(),V(yt,{key:1,element:f},Q({_:2},[U(r(o),_=>({name:_.type,fn:e(({node:g})=>[N(d.$slots,_.type,{node:g})])}))]),1032,["element"])),be(m("div",{class:M(["widget-view-action",{"widget-col-action":r(G)(f.type)}])},[m("i",{class:"b-iconfont b-icon-delete",title:"删除",onClick:ee(_=>r(l)(n.widgets,b),["stop"])},null,8,kt)],2),[[ve,r(c)(f)]]),be(m("div",{class:M(["widget-view-drag",{"widget-col-drag":r(G)(f.type)}])},Vt,2),[[ve,r(c)(f)]]),m("div",wt,[m("span",null,T(f.model),1)])],10,ht)]),_:3},8,["list"])}}}),xt={class:"widget-form-container"},St=Object.assign({name:"WidgetForm"},{__name:"WidgetForm",setup(n){const{widgetForm:a,slotsWedigets:o}=L();return(c,l)=>{const p=u("b-form");return s(),k("div",xt,[t(p,{ref:"formRef","label-position":r(a).config.labelPosition,"label-suffix":r(a).config.labelSuffix,"label-width":`${r(a).config.labelWidth}px`,size:r(a).config.size},{default:e(()=>[t($t,{class:"widget-form-list",widgets:r(a).list},Q({_:2},[U(r(o),i=>({name:i.type,fn:e(({node:d})=>[N(c.$slots,i.type,{node:d})])}))]),1032,["widgets"])]),_:3},8,["label-position","label-suffix","label-width","size"])])}}}),Dt={name:"ActionButton",props:{buttonProps:{type:Object},popperWidth:{type:Number,default:260},message:{type:String,default:"确定删除本条数据吗？"},disabled:Boolean,confirm:Boolean,tooltip:String,icon:String,type:String,color:String,isIcon:Boolean,loading:Boolean,iconStyle:{type:Object,default:()=>({fontSize:"18px"})}},data(){return{visible:!1}},emits:["cancel","click"],computed:{btnProps(){return{type:this.type,textColor:this.color,disabled:this.disabled,loading:this.loading,...this.buttonProps}}},methods:{handleCancel(){this.visible=!1,this.$emit("cancel")},handleOk(){this.visible=!1,this.$emit("click")},handleClick(){this.confirm||this.$emit("click")}}},Wt={style:{"line-height":"22px","margin-bottom":"8px"}},Ft={style:{"text-align":"right",margin:"0"}};function Tt(n,a,o,c,l,p){const i=u("b-button"),d=u("b-icon"),y=u("b-popover");return s(),V(y,{visible:l.visible,"onUpdate:visible":a[0]||(a[0]=v=>l.visible=v),width:o.popperWidth,disabled:!o.confirm},{content:e(()=>[m("p",Wt,[t(d,{name:"question-circle",size:"16",color:"#fa8c16"}),h(" "+T(o.message),1)]),m("div",Ft,[t(i,{size:"mini",type:"text",onClick:p.handleCancel},{default:e(()=>[h("取消")]),_:1},8,["onClick"]),t(i,{type:"primary",size:"mini",onClick:p.handleOk},{default:e(()=>[h("确认")]),_:1},8,["onClick"])])]),default:e(()=>[t(i,re(p.btnProps,{onClick:p.handleClick,title:o.tooltip}),{default:e(()=>[o.icon?(s(),k("i",{key:0,class:M(`b-iconfont b-icon-${o.icon}`),style:Fe(o.iconStyle)},null,6)):W("",!0),N(n.$slots,"default")]),_:3},16,["onClick","title"])]),_:3},8,["visible","width","disabled"])}const J=P(Dt,[["render",Tt]]),pe=Object.assign({name:"DebugModal"},{__name:"index",props:{data:{type:[Object,Array]},title:{type:String,default:"查看json"},width:{type:String,default:"600px"},height:{type:String,default:"400px"}},setup(n,{expose:a}){const o=n,c=D(""),l=D(!1),p=D(!1);function i(){p.value=!1,c.value=JSON.stringify(o.data,null,2),l.value=!0}function d(){p.value=!0}function y(v){p.value=!1,c.value=JSON.stringify(v,null,2),l.value=!0}return a({show:y}),(v,f)=>{const b=u("b-icon"),_=u("b-button"),g=u("b-ace-editor"),O=u("b-skeleton"),j=u("b-modal");return s(),k("div",{onClick:i},[N(v.$slots,"default",{},()=>[t(_,{onClick:i,type:"text","text-color":"danger"},{default:e(()=>[t(b,{name:"bug",size:"18"})]),_:1})]),t(j,{title:n.title,"append-to-body":"",modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=F=>l.value=F),width:n.width,onOpened:d,"screen-center":""},{default:e(()=>[t(O,{loading:!p.value,animation:"",rows:10},{default:e(()=>[t(g,{"model-value":c.value,readonly:"",height:n.height},null,8,["model-value","height"])]),_:1},8,["loading"])]),_:1},8,["title","modelValue","width"])])}}}),Ot={class:"custom-input"},jt={flex:"cross:center",class:"mb-5"},we=Object.assign({name:"BFCustomNode"},{__name:"CustomNode",props:I({data:{type:Object,required:!0},formConfig:{type:Object,required:!0}},{modelValue:{type:String,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const a=n,o=Y(n,"modelValue");return ae(()=>a.data.config),(c,l)=>{const p=u("b-tag"),i=u("b-input");return s(),k("div",Ot,[m("div",jt,[t(p,null,{default:e(()=>[h("自定义组件")]),_:1}),h(" "+T(o.value),1)]),t(i,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=d=>o.value=d)},null,8,["modelValue"])])}}}),zt={class:"preview",style:{"min-height":"520px"}},Ut={flex:"main:center cross:center"},Nt=Object.assign({name:"FormPreview"},{__name:"index",setup(n,{expose:a}){const o=D(!1),c=D("EDIT"),{initSchema:l,formModels:p}=Re(),i=D({}),d=D(null);function y(b,_){o.value=!0,l(b,_)}async function v(){var _;const b=await((_=d.value)==null?void 0:_.getFormData());b?(ne.success("校验通过!"),console.log(b)):ne.error("校验失败!")}function f(){var b;(b=d.value)==null||b.resetForm()}return a({open:y}),(b,_)=>{const g=u("BFRenderForm"),O=u("b-button"),j=u("b-modal");return s(),V(j,{modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=F=>o.value=F),title:"表单预览",width:"1400px","screen-center":""},{footer:e(()=>[m("div",Ut,[t(O,{onClick:_[0]||(_[0]=F=>o.value=!1)},{default:e(()=>[h("关 闭")]),_:1}),c.value!=="DETAIL"?(s(),k(R,{key:0},[t(O,{onClick:f},{default:e(()=>[h("重 置")]),_:1}),t(pe,{style:{display:"inline-block",margin:"0 8px"},data:{formModels:r(p)},title:"查看数据"},{default:e(()=>[t(O,{icon:"edit-square"},{default:e(()=>[h("查看数据")]),_:1})]),_:1},8,["data"]),t(O,{type:"primary",onClick:v},{default:e(()=>[h("测试提交")]),_:1})],64)):W("",!0)])]),default:e(()=>[m("div",zt,[o.value?(s(),V(g,{key:0,"default-model":i.value,ref_key:"renderFormRef",ref:d},{"custom-comp":e(({node:F})=>[t(we,re(F,{modelValue:r(p)[F.data.model],"onUpdate:modelValue":B=>r(p)[F.data.model]=B}),null,16,["modelValue","onUpdate:modelValue"])]),_:1},8,["default-model"])):W("",!0)])]),_:1},8,["modelValue"])}}}),Bt={class:"center-container"},At={class:"top-fix",flex:"main:justify cross:center"},Rt={class:"top-fix-left",flex:"cross:center"},Mt={class:"top-fix-right"},Lt={class:"scroll-content"},Et={key:0,class:"form-empty"},It=Object.assign({name:"CenterContainer"},{__name:"index",emits:["onSave"],setup(n,{emit:a}){const o=a,{widgetForm:c,slotsWedigets:l,clearSchema:p,quickLayout:i,realFieldsDtos:d}=L();function y(g,O){const j={pdf:"application/pdf",doc:"application/vnd.ms-word",docx:"application/vnd.ms-word",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint",js:"application/x-javascript",json:"application/json",zip:"application/zip",mp3:"audio/mpeg",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",txt:"text/plain",xml:"image/text/xml"},F=O.split(".").pop().toLocaleLowerCase()||"",B=new Blob([g],{type:j[F]});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(B,O);else{const S=document.createElement("a");S.href=window.URL.createObjectURL(B),S.setAttribute("download",O),document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(S.href)}}const v=()=>{y(JSON.stringify(c.value,null,2),`form_${Me()}.json`),ne.success({message:"模板文件已保存！",showClose:!0})};function f(){o("onSave")}const b=D(null);function _(){var g;(g=b.value)==null||g.open(c.value,l.value)}return(g,O)=>{const j=u("b-button"),F=u("b-dropdown-item"),B=u("b-dropdown-menu"),S=u("b-dropdown"),A=u("b-divider"),ie=u("b-empty"),se=u("b-scrollbar");return s(),k("div",Bt,[m("div",At,[m("div",Rt,[r(d).length?(s(),V(S,{key:0,onCommand:r(i)},{dropdown:e(()=>[t(B,null,{default:e(()=>[t(F,{name:1},{default:e(()=>[h("通栏布局")]),_:1}),t(F,{name:2},{default:e(()=>[h("双列布局")]),_:1}),t(F,{name:4},{default:e(()=>[h("四列布局")]),_:1})]),_:1})]),default:e(()=>[t(j,{icon:"layout",type:"text"},{default:e(()=>[h("快速配置")]),_:1})]),_:1},8,["onCommand"])):W("",!0)]),m("div",Mt,[t(j,{type:"text",icon:"eye",onClick:_},{default:e(()=>[h("预览")]),_:1}),t(A,{type:"vertical"}),t(pe,{style:{display:"inline-block"},data:{widgetForm:r(c)}},{default:e(()=>[t(j,{type:"text",icon:"edit-square"},{default:e(()=>[h("查看JSON")]),_:1})]),_:1},8,["data"]),t(A,{type:"vertical"}),t(j,{type:"text",icon:"export",onClick:v},{default:e(()=>[h("导出JSON")]),_:1}),t(A,{type:"vertical"}),t(j,{type:"text",icon:"save",onClick:f},{default:e(()=>[h("保存")]),_:1}),t(A,{type:"vertical"}),t(J,{type:"text",color:"#f5222d",icon:"delete",message:"确认清空画布吗？",confirm:"",onClick:r(p)},{default:e(()=>[h(" 清空 ")]),_:1},8,["onClick"])])]),m("div",Lt,[t(se,null,{default:e(()=>[r(c).list.length===0?(s(),k("div",Et,[t(ie,null,{default:e(()=>[h("从左侧拖拽或点击来添加字段")]),_:1})])):W("",!0),t(St,null,Q({_:2},[U(r(l),q=>({name:q.type,fn:e(({node:X})=>[N(g.$slots,q.type,{node:X},void 0,!0)])}))]),1024)]),_:3})]),t(Nt,{ref_key:"previewRef",ref:b},Q({_:2},[U(r(l),q=>({name:q.type,fn:e(({node:X})=>[N(g.$slots,q.type,{node:X},void 0,!0)])}))]),1536)])}}}),Pt=P(It,[["__scopeId","data-v-5ed672fb"]]),qt={class:"form-config-container"},Ht={key:0,class:"radio-group"},Jt={class:"config-content"},Yt=Object.assign({name:"WidgetConfig"},{__name:"WidgetConfig",props:I({size:{type:String,default:"small"}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const a=Y(n,"modelValue"),o=D("base"),c=D([]);return ke(()=>a.value.key,()=>{o.value="base",c.value=Le(a.value.type)?[{title:"基础",key:"base"},{title:"选项",key:"options"},{title:"验证",key:"validate"}]:[{title:"基础",key:"base"},{title:"验证",key:"validate"}]},{immediate:!0}),(l,p)=>{const i=u("b-radio"),d=u("b-radio-group"),y=u("b-scrollbar");return s(),k("div",qt,[r(G)(a.value.type)?W("",!0):(s(),k("div",Ht,[t(d,{modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=v=>o.value=v),size:"default",type:"capsule"},{default:e(()=>[(s(!0),k(R,null,U(c.value,v=>(s(),V(i,{label:v.key,key:v.key},{default:e(()=>[h(T(v.title),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])),m("div",Jt,[t(y,null,{default:e(()=>[(s(),V(me(`BF-${a.value.type}-config`),{modelValue:a.value,"onUpdate:modelValue":p[1]||(p[1]=v=>a.value=v),tab:o.value},null,8,["modelValue","tab"]))]),_:1})])])}}}),Kt=P(Yt,[["__scopeId","data-v-09325009"]]),K=n=>(Te("data-v-6b901076"),n=n(),Oe(),n),Qt=K(()=>m("div",{class:"title"},"字段列表",-1)),Xt={key:1},Zt=["onDragstart"],Gt={class:"field-name"},el={class:"right-box"},tl={class:"right-top"},ll=K(()=>m("div",{class:"title"},"规则条件",-1)),ol={class:"p8"},nl={style:{padding:"0 8px"}},al=K(()=>m("span",null,"可放置此处增加规则条件",-1)),il=[al],sl={class:"right-half"},dl=K(()=>m("div",{class:"title"},"满足动作",-1)),cl={class:"p8"},ul={style:{padding:"0 8px"}},rl=K(()=>m("span",null,"可放置此处增加满足动作",-1)),ml=[rl],pl={class:"right-half"},fl=K(()=>m("div",{class:"title"},"不满足动作",-1)),_l={class:"p8"},bl={style:{padding:"0 8px"}},vl=K(()=>m("span",null,"可放置此处增加不满足动作",-1)),gl=[vl],yl=Object.assign({name:"EventConfigModal"},{__name:"ConfigModal",setup(n,{expose:a}){const o=D(!1),c=D(-1),l=D({}),{realFieldWedgits:p,formConfig:i}=L(),d=ae(()=>i.value.globalEvents.onEvents),y=D(!1);function v(w,x){c.value=x,l.value=w,o.value=!0}function f(){c.value===-1?d.value.push(l.value):d.value.splice(c.value,1,l.value),o.value=!1}const b=[{title:" ",slot:"handle",width:40,align:"center"},{title:"字段标识",slot:"fieldName",minWidth:100,tooltip:!0},{title:"匹配条件",slot:"compare",minWidth:100,tooltip:!0},{title:"匹配值",slot:"value",minWidth:100,tooltip:!0},{title:" ",slot:"action",width:40,align:"center"}],_=[{title:" ",slot:"handle",width:40,align:"center"},{title:"字段标识",slot:"fieldName",minWidth:100,tooltip:!0},{title:"执行动作",slot:"oType",minWidth:100,tooltip:!0},{title:" ",slot:"action",width:40,align:"center"}];a({open:v});function g(){y.value=!1}function O(w,x){w.dataTransfer.setData("Field",JSON.stringify(x)),console.log(x),y.value=!0}function j(w){w.preventDefault();let x=w.dataTransfer.getData("Field");const z=JSON.parse(x);if(l.value.fields.findIndex(Z=>Z.fieldName===z.model)>-1){ne.warning("已存在字段，无需重复设置");return}l.value.fields.push({fieldName:z.model,fieldTitle:z.label,compare:"",value:z.type==="input-number"?null:"",type:z.type})}function F(w){w.preventDefault();let x=w.dataTransfer.getData("Field");const z=JSON.parse(x);l.value.actions.push({fieldName:z.model,fieldTitle:z.label,oType:""})}function B(w){w.preventDefault();let x=w.dataTransfer.getData("Field");const z=JSON.parse(x);l.value.disActions.push({fieldName:z.model,fieldTitle:z.label,oType:""})}function S(w){l.value.fields=[...w]}function A(w){l.value.actions=[...w]}function ie(w){l.value.disActions=[...w]}function se(w){l.value.fields.splice(w,1)}function q(w){l.value.actions.splice(w,1)}function X(w){l.value.disActions.splice(w,1)}return(w,x)=>{var _e;const z=u("b-empty"),Z=u("b-tag"),de=u("b-option"),ce=u("b-select"),$e=u("b-input-number"),xe=u("b-input"),ue=u("b-table"),Se=u("b-layout"),fe=u("b-button"),De=u("b-modal");return s(),V(De,{modelValue:o.value,"onUpdate:modelValue":x[4]||(x[4]=C=>o.value=C),title:`界面事件${c.value===-1?"新增":"编辑"}: ${((_e=l.value)==null?void 0:_e.name)||""}`,width:"1280px",top:"50px","body-styles":{padding:0},"mask-closable":!1},{footer:e(()=>[t(fe,{onClick:x[3]||(x[3]=C=>o.value=!1)},{default:e(()=>[h("取消")]),_:1}),t(fe,{type:"primary",onClick:f},{default:e(()=>[h("确定")]),_:1})]),default:e(()=>[t(Se,{"has-sider":"",style:{height:"520px"}},{sider:e(()=>[Qt,r(p).length===0?(s(),V(z,{key:0},{default:e(()=>[h("面板暂无字段控件")]),_:1})):(s(),k("ul",Xt,[(s(!0),k(R,null,U(r(p),C=>(s(),k("li",{class:"form-edit-widget-label no-put",key:C.model,draggable:"true",onDragstart:$=>O($,C),onDragend:g},[m("a",null,[m("span",Gt,T(C.label),1)])],40,Zt))),128))]))]),default:e(()=>[m("div",el,[m("div",tl,[ll,m("div",ol,[t(ue,{columns:b,data:l.value.fields,"edit-table":"",draggable:"","max-height":"192",DragHandle:".handle",onDragDrop:S},{handle:e(()=>[t(oe)]),fieldName:e(({index:C})=>[m("div",nl,[t(Z,{title:l.value.fields[C].fieldName},{default:e(()=>[h(T(l.value.fields[C].fieldTitle),1)]),_:2},1032,["title"])])]),compare:e(({index:C})=>[t(ce,{modelValue:l.value.fields[C].compare,"onUpdate:modelValue":$=>l.value.fields[C].compare=$,clearable:""},{default:e(()=>[(s(!0),k(R,null,U(l.value.fields[C].type==="input-number"?r(Ee):r(Ie),($,E)=>(s(),V(de,{key:E,value:E,label:$},{default:e(()=>[h(T($),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),value:e(({index:C})=>[l.value.fields[C].type==="input-number"?(s(),V($e,{key:0,modelValue:l.value.fields[C].value,"onUpdate:modelValue":$=>l.value.fields[C].value=$},null,8,["modelValue","onUpdate:modelValue"])):(s(),V(xe,{key:1,modelValue:l.value.fields[C].value,"onUpdate:modelValue":$=>l.value.fields[C].value=$},null,8,["modelValue","onUpdate:modelValue"]))]),action:e(({index:C})=>[t(J,{type:"text",icon:"minus-circle",color:"danger","is-icon":"",tooltip:"删除",onClick:$=>se(C)},null,8,["onClick"])]),_:1},8,["data"])]),t(le,{name:"fade-in"},{default:e(()=>[y.value?(s(),k("div",{key:0,class:"top-mask",onDragover:x[0]||(x[0]=ee(()=>{},["prevent"])),onDrop:j},il,32)):W("",!0)]),_:1})]),m("div",sl,[dl,m("div",cl,[t(ue,{columns:_,data:l.value.actions,"edit-table":"",draggable:"",DragHandle:".handle",onDragDrop:A,"max-height":"192"},{handle:e(()=>[t(oe)]),fieldName:e(({index:C})=>[m("div",ul,[t(Z,{title:l.value.actions[C].fieldName},{default:e(()=>[h(T(l.value.actions[C].fieldTitle),1)]),_:2},1032,["title"])])]),oType:e(({index:C})=>[t(ce,{modelValue:l.value.actions[C].oType,"onUpdate:modelValue":$=>l.value.actions[C].oType=$,clearable:""},{default:e(()=>[(s(!0),k(R,null,U(r(he),($,E)=>(s(),V(de,{key:E,value:E,label:$},{default:e(()=>[h(T($),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),action:e(({index:C})=>[t(J,{type:"text",icon:"minus-circle",color:"danger","is-icon":"",tooltip:"删除",onClick:$=>q(C)},null,8,["onClick"])]),_:1},8,["data"])]),t(le,{name:"fade-in"},{default:e(()=>[y.value?(s(),k("div",{key:0,class:"top-mask match",onDragover:x[1]||(x[1]=ee(()=>{},["prevent"])),onDrop:F},ml,32)):W("",!0)]),_:1})]),m("div",pl,[fl,m("div",_l,[t(ue,{columns:_,data:l.value.disActions,"edit-table":"",draggable:"",DragHandle:".handle",onDragDrop:ie,"max-height":"192"},{handle:e(()=>[t(oe)]),fieldName:e(({index:C})=>[m("div",bl,[t(Z,{title:l.value.disActions[C].fieldName},{default:e(()=>[h(T(l.value.disActions[C].fieldTitle),1)]),_:2},1032,["title"])])]),oType:e(({index:C})=>[t(ce,{modelValue:l.value.disActions[C].oType,"onUpdate:modelValue":$=>l.value.disActions[C].oType=$,clearable:""},{default:e(()=>[(s(!0),k(R,null,U(r(he),($,E)=>(s(),V(de,{key:E,value:E,label:$},{default:e(()=>[h(T($),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),action:e(({index:C})=>[t(J,{type:"text",icon:"minus-circle",color:"danger","is-icon":"",tooltip:"删除",onClick:$=>X(C)},null,8,["onClick"])]),_:1},8,["data"])]),t(le,{name:"fade-in"},{default:e(()=>[y.value?(s(),k("div",{key:0,class:"top-mask no-match",onDragover:x[2]||(x[2]=ee(()=>{},["prevent"])),onDrop:B},gl,32)):W("",!0)]),_:1})])])]),_:1})]),_:1},8,["modelValue","title"])}}}),hl=P(yl,[["__scopeId","data-v-6b901076"]]),kl={class:"events-cfg"},Cl={class:"pt-10 pb-5"},Vl=Object.assign({name:"EventsCfg"},{__name:"index",props:I({size:{type:String,default:"small"},labelWidth:{type:String,default:"85px"}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const a=Y(n,"modelValue"),o=ae(()=>a.value.globalEvents),{paramsDesc:c,exampleDesc:l}=Pe(),p=[{title:" ",slot:"handle",width:40,align:"center"},{title:"界面事件名称",slot:"name",minWidth:100,tooltip:!0},{title:" ",slot:"action",width:60,align:"center"}];function i(b){o.value.onEvents=[...b]}function d(b){o.value.onEvents.splice(b,1)}function y(){var _;const b={name:"新事件名称"+o.value.onEvents.length,fields:[],actions:[],disActions:[]};(_=v.value)==null||_.open(b,-1)}const v=D(null);function f(b){var g;const _=He(o.value.onEvents[b]);(g=v.value)==null||g.open(_,b)}return(b,_)=>{const g=u("b-radio"),O=u("b-radio-group"),j=u("b-input"),F=u("b-table"),B=u("b-button");return s(),k("div",kl,[t(H,{label:"事件类型",labelWidth:n.labelWidth},{default:e(()=>[t(O,{modelValue:o.value.type,"onUpdate:modelValue":_[0]||(_[0]=S=>o.value.type=S),type:"button",size:n.size},{default:e(()=>[t(g,{label:"simple"},{default:e(()=>[h("配置模式")]),_:1}),t(g,{label:"script"},{default:e(()=>[h("高级脚本")]),_:1})]),_:1},8,["modelValue","size"])]),_:1},8,["labelWidth"]),o.value.type==="simple"?(s(),k(R,{key:0},[t(F,{columns:p,data:o.value.onEvents,"edit-table":"",draggable:"",DragHandle:".handle",onDragDrop:i},{handle:e(()=>[t(oe)]),name:e(({index:S})=>[t(j,{modelValue:o.value.onEvents[S].name,"onUpdate:modelValue":A=>o.value.onEvents[S].name=A},null,8,["modelValue","onUpdate:modelValue"])]),action:e(({index:S})=>[t(J,{type:"text",icon:"edit","is-icon":"",tooltip:"编辑",onClick:A=>f(S)},null,8,["onClick"]),t(J,{type:"text",icon:"minus-circle",color:"danger","is-icon":"",tooltip:"删除",onClick:A=>d(S)},null,8,["onClick"])]),_:1},8,["data"]),m("div",Cl,[t(B,{icon:"plus",dashed:"",size:"small",style:{width:"100%","border-radius":"8px"},onClick:y},{default:e(()=>[h(" 新增事件 ")]),_:1})])],64)):W("",!0),o.value.type==="script"?(s(),V(H,{key:1,label:"脚本函数",tooltip:"脚本函数作为高级用法，可以满足更多自定义设置",labelWidth:n.labelWidth},{default:e(()=>[t(qe,{modelValue:o.value.customScript.funcBody,"onUpdate:modelValue":_[1]||(_[1]=S=>o.value.customScript.funcBody=S),arguments:o.value.customScript.arguments,style:{display:"inline-flex",width:"auto"},paramsDesc:r(c),exampleDesc:r(l),label:"",funcExplain:"通过提供的参数编写脚本，可以实现更灵活的表单界面控制。"},null,8,["modelValue","arguments","paramsDesc","exampleDesc"])]),_:1},8,["labelWidth"])):W("",!0),t(hl,{ref_key:"eventRef",ref:v},null,512)])}}}),wl={class:"form-config-container"},$l={class:"radio-group"},xl={class:"config-content"},Sl={class:"comp-config-container"},Dl={key:0},Wl={key:1},Fl=Object.assign({name:"FormConfig"},{__name:"FormConfig",props:I({size:{type:String,default:"small"},labelWidth:{type:String,default:"85px"}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const a=Y(n,"modelValue"),o=D("base"),c=[{key:"dict1",name:"字典名1",options:[{key:"o1",label:"标签1"}]},{key:"dict2",name:"字典名2",options:[{key:"o1",label:"标签1"}]}],l=[{title:"基础",key:"base"},{title:"数据",key:"datasouce"},{title:"事件",key:"event"}];return(p,i)=>{const d=u("b-radio"),y=u("b-radio-group"),v=u("b-input-number"),f=u("b-input"),b=u("b-button"),_=u("b-scrollbar");return s(),k("div",wl,[m("div",$l,[t(y,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=g=>o.value=g),size:"default",type:"capsule"},{default:e(()=>[(s(),k(R,null,U(l,g=>t(d,{label:g.key,key:g.key},{default:e(()=>[h(T(g.title),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),m("div",xl,[t(_,null,{default:e(()=>[m("div",Sl,[o.value==="base"?(s(),k("div",Dl,[t(H,{label:"标签对齐",labelWidth:n.labelWidth},{default:e(()=>[t(y,{modelValue:a.value.labelPosition,"onUpdate:modelValue":i[1]||(i[1]=g=>a.value.labelPosition=g),type:"button",size:n.size},{default:e(()=>[t(d,{label:"left"},{default:e(()=>[h("左侧")]),_:1}),t(d,{label:"top"},{default:e(()=>[h("顶部")]),_:1}),t(d,{label:"right"},{default:e(()=>[h("右侧")]),_:1})]),_:1},8,["modelValue","size"])]),_:1},8,["labelWidth"]),t(H,{label:"标签宽度",labelWidth:n.labelWidth},{default:e(()=>[t(v,{modelValue:a.value.labelWidth,"onUpdate:modelValue":i[2]||(i[2]=g=>a.value.labelWidth=g),min:60,max:300,step:5,size:n.size,disabled:a.value.labelPosition==="top"},null,8,["modelValue","size","disabled"])]),_:1},8,["labelWidth"]),t(H,{label:"标签后缀",labelWidth:n.labelWidth},{default:e(()=>[t(f,{modelValue:a.value.labelSuffix,"onUpdate:modelValue":i[3]||(i[3]=g=>a.value.labelSuffix=g),size:n.size,clearable:""},null,8,["modelValue","size"])]),_:1},8,["labelWidth"]),t(H,{label:"组件尺寸",labelWidth:n.labelWidth},{default:e(()=>[t(y,{modelValue:a.value.size,"onUpdate:modelValue":i[4]||(i[4]=g=>a.value.size=g),type:"button",size:n.size},{default:e(()=>[t(d,{label:"large"},{default:e(()=>[h("大号")]),_:1}),t(d,{label:"default"},{default:e(()=>[h("默认")]),_:1}),t(d,{label:"small"},{default:e(()=>[h("小号")]),_:1})]),_:1},8,["modelValue","size"])]),_:1},8,["labelWidth"])])):W("",!0),o.value==="datasouce"?(s(),k("div",Wl,[N(p.$slots,"DataSetCfg",{dataset:a.value.dataSet},()=>[t(H,{label:"数据配置",tooltip:"基于一定规则进行配置，这里通过一个固定插槽[DataSetCfg]予以动态抛出,作用域属性dataset用于外部设置。",labelWidth:n.labelWidth},{default:e(()=>[t(pe,{style:{display:"inline-block"},data:c,title:"格式查看"},{default:e(()=>[t(b,{type:"text"},{default:e(()=>[h("格式查看")]),_:1})]),_:1})]),_:1},8,["labelWidth"])],!0)])):W("",!0),o.value==="event"?(s(),V(Vl,{key:2,modelValue:a.value,"onUpdate:modelValue":i[5]||(i[5]=g=>a.value=g)},null,8,["modelValue"])):W("",!0)])]),_:3})])])}}}),Tl=P(Fl,[["__scopeId","data-v-f5e14632"]]),Ol={class:"right-config-container"},jl={class:"top-fix"},zl=["onClick"],Ul={class:"config-content"},Nl={key:0,style:{height:"100%"}},Bl={key:1,style:{height:"300px"},flex:"main:center cross:center"},Al=Object.assign({name:"RightConfig"},{__name:"index",setup(n){const{selectWidget:a,currentCfgTab:o,widgetForm:c}=L(),l=[{key:"widget",title:"控件属性"},{key:"form",title:"表单属性"}];return(p,i)=>(s(),k("div",Ol,[m("div",jl,[(s(),k(R,null,U(l,d=>m("div",{key:d.key,class:M(["tab-item",{active:d.key===r(o)}]),onClick:y=>o.value=d.key},T(d.title),11,zl)),64))]),m("div",Ul,[r(o)==="widget"?(s(),k("div",Nl,[r(a)?(s(),V(Kt,{key:0,modelValue:r(a),"onUpdate:modelValue":i[0]||(i[0]=d=>Ve(a)?a.value=d:null)},null,8,["modelValue"])):(s(),k("div",Bl,"请添加组件"))])):(s(),V(Tl,{key:1,modelValue:r(c).config,"onUpdate:modelValue":i[1]||(i[1]=d=>r(c).config=d)},{DataSetCfg:e(({dataset:d})=>[N(p.$slots,"DataSetCfg",{dataset:d})]),_:3},8,["modelValue"]))])]))}}),Rl=Object.assign({name:"BFormMaker"},{__name:"index",props:I({topTitle:{type:String,default:"FormMaker 表单设计器"},inner:Boolean,customFields:{type:Array,default:()=>[]},realFields:{type:Array,default:()=>[]}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:I(["onSave"],["update:modelValue"]),setup(n,{emit:a}){const o=a,c=n,l=Y(n,"modelValue"),{widgetForm:p,slotsWedigets:i,realFieldsDtos:d}=L();i.value=[...c.customFields],d.value=[...c.realFields];function y(){o("onSave",p.value)}return(v,f)=>(s(),V(ot,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=b=>l.value=b),topTitle:n.topTitle,inner:n.inner},{default:e(()=>[t(bt),t(Pt,{onOnSave:y},Q({_:2},[U(r(i),b=>({name:b.type,fn:e(({node:_})=>[N(v.$slots,b.type,{node:_})])}))]),1024),t(Al,null,{DataSetCfg:e(({dataset:b})=>[N(v.$slots,"DataSetCfg",{dataset:b})]),_:3})]),_:3},8,["modelValue","topTitle","inner"]))}}),Ml={class:"form-dict-wrap"},Ll={class:"pt-8"},El={__name:"DatasetCfg",props:{modelValue:{type:Object},modelModifiers:{}},emits:["update:modelValue"],setup(n){const a=Y(n,"modelValue"),o=[{title:"字典名称",key:"key",minWidth:100,tooltip:!0},{title:"字典编码",key:"name",minWidth:100,tooltip:!0},{title:" ",slot:"action",width:50,align:"center"}],c=ae(()=>a.value.dataSet);function l(i){c.value.splice(i,1)}function p(){c.value.push({key:"newKey_"+c.value.length,name:"模拟字典"+c.value.length,options:[{key:"o1",label:"标签1"},{key:"o2",label:"标签2"}]})}return(i,d)=>{const y=u("b-table"),v=u("b-button");return s(),k("div",Ml,[t(y,{columns:o,data:c.value,size:"small","max-height":"440","edit-table":"","edit-table-detail":""},{action:e(({index:f})=>[t(J,{type:"text",icon:"minus-circle",color:"danger","is-icon":"",tooltip:"删除",onClick:b=>l(f)},null,8,["onClick"])]),_:1},8,["data"]),m("div",Ll,[t(v,{icon:"book",dashed:"",size:"small",style:{width:"100%","border-radius":"8px"},onClick:p},{default:e(()=>[h(" 表单字典配置 ")]),_:1})])])}}},Il={class:"p24"},Yl={__name:"home",setup(n){const a=D(!1),o=D(null),{formConfig:c,initSchema:l}=Je(),p=[{type:"custom-comp",name:"自定义组件",icon:"appstoreadd"}],i=[{fieldName:"fname",fieldTitle:"员工姓名",fieldLength:10,fieldType:"string",required:!0},{fieldName:"fnumber",fieldTitle:"员工编号",fieldLength:10,fieldType:"string",required:!0},{fieldName:"fage",fieldTitle:"员工年龄",fieldLength:10,fieldType:"number",required:!1},{fieldName:"merit_pay",fieldTitle:"基本工资",fieldLength:10,fieldType:"number",required:!1},{fieldName:"year_month",fieldTitle:"薪资周期",fieldLength:10,fieldType:"string",required:!1},{fieldName:"birthday",fieldTitle:"出生日期",fieldLength:null,fieldType:"date",required:!1}];function d(v){console.log(v)}function y(){l({},i,p),a.value=!0}return l({}),a.value=!0,(v,f)=>{const b=u("b-button");return s(),k("div",Il,[t(b,{type:"primary",onClick:y},{default:e(()=>[h("打开设计器")]),_:1}),t(Rl,{modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=_=>a.value=_),customFields:p,realFields:i,ref_key:"makerRef",ref:o,onOnSave:d},{"custom-comp":e(({node:_})=>[t(we,je(ze(_)),null,16)]),DataSetCfg:e(()=>[t(El,{modelValue:r(c),"onUpdate:modelValue":f[0]||(f[0]=_=>Ve(c)?c.value=_:null)},null,8,["modelValue"])]),_:1},8,["modelValue"])])}}};export{Yl as default};
